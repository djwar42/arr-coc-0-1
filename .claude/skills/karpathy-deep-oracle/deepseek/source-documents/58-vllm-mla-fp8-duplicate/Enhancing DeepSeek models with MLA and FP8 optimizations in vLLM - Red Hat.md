---
sourceFile: "Enhancing DeepSeek models with MLA and FP8 optimizations in vLLM - Red Hat"
exportedBy: "Kortex"
exportDate: "2025-10-29T02:36:26.901Z"
---

# Enhancing DeepSeek models with MLA and FP8 optimizations in vLLM - Red Hat

bf3677ae-8b94-4dd4-bbbb-cda43a891287

Enhancing DeepSeek models with MLA and FP8 optimizations in vLLM - Red Hat

05ed95de-923d-4500-9eb8-d0c2dbf1e61e

https://www.redhat.com/en/blog/enhancing-deepseek-models-mla-and-fp8-optimizations-vllm

## Skip to content

https://www.redhat.com/en

## Our approach

## News and insights

https://www.redhat.com/en

## Technical blog

https://www.redhat.com/en

https://www.redhat.com/en

## Live AI events

https://www.redhat.com/en

## Explore AI at Red Hat

https://www.redhat.com/en

## Our portfolio

## Red Hat AI

https://www.redhat.com/en

## Red Hat Enterprise Linux AI

https://www.redhat.com/en

## Red Hat OpenShift AI

https://www.redhat.com/en

## Red Hat AI Inference Server

https://www.redhat.com/en

Engage & learn

## AI learning hub

https://www.redhat.com/en

## AI partners

https://www.redhat.com/en

## Services for AI

https://www.redhat.com/en

## Hybrid cloud

## Platform solutions

## Artificial intelligence

https://www.redhat.com/en

Build, deploy, and monitor AI models and apps.

## Linux standardization

https://www.redhat.com/en

Get consistency across operating environments.

## Application development

https://www.redhat.com/en

Simplify the way you build, deploy, and manage apps.

https://www.redhat.com/en

Scale automation and unite tech, teams, and environments.

## Explore solutions

https://www.redhat.com/en

## Virtualization

https://www.redhat.com/en

Modernize operations for virtualized and containerized workloads.

## Digital sovereignty

https://www.redhat.com/en

Control and protect critical infrastructure.

https://www.redhat.com/en

Code, build, deploy, and monitor security-focused software.

## Edge computing

https://www.redhat.com/en

Deploy workloads closer to the source with edge technology.

## Solutions by industry

## Automotive

https://www.redhat.com/en

## Financial services

https://www.redhat.com/en

## Healthcare

https://www.redhat.com/en

## Industrial sector

https://www.redhat.com/en

## Media and entertainment

https://www.redhat.com/en

## Public sector

https://www.redhat.com/en

## Telecommunications

https://www.redhat.com/en

## Discover cloud technologies

https://www.redhat.com/en

Learn how to use our cloud products and solutions at your own pace in the Red Hat® Hybrid Cloud Console.

https://www.redhat.com/en

Develop and deploy AI solutions across the hybrid cloud.

## New version

## Red Hat Enterprise Linux

https://www.redhat.com/en

Support hybrid cloud innovation on a flexible operating system.

## Red Hat OpenShift

https://www.redhat.com/en

Build, modernize, and deploy apps at scale.

## Red Hat Ansible Automation Platform

https://www.redhat.com/en

Implement enterprise-wide automation.

## Red Hat OpenShift Virtualization Engine

https://www.redhat.com/en

## Red Hat OpenShift Service on AWS

https://www.redhat.com/en

## Microsoft Azure Red Hat OpenShift

https://www.redhat.com/en

## See all products

https://www.redhat.com/en

## Start a trial

https://www.redhat.com/en

## Buy online

https://www.redhat.com/en

## Integrate with major cloud providers

https://www.redhat.com/en

Services & support

## Consulting

https://www.redhat.com/en

## Product support

https://www.redhat.com/en

## Services for AI

https://www.redhat.com/en

## Technical Account Management

https://www.redhat.com/en

## Explore services

https://www.redhat.com/en

Training & certification

## Courses and exams

https://www.redhat.com/en

## Certifications

https://www.redhat.com/en

## Red Hat Academy

https://www.redhat.com/en

## Learning community

https://www.redhat.com/en

## Learning subscription

https://www.redhat.com/en

## Explore training

https://www.redhat.com/en

## Red Hat Certified System Administrator exam

https://www.redhat.com/en

## Red Hat System Administration I

https://www.redhat.com/en

Red Hat Learning Subscription trial (No cost)

https://www.redhat.com/en

## Red Hat Certified Engineer exam

https://www.redhat.com/en

## Red Hat Certified OpenShift Administrator exam

https://www.redhat.com/en

## Consulting

https://www.redhat.com/en

## Partner training

https://www.redhat.com/en

## Product support

https://www.redhat.com/en

## Services for AI

https://www.redhat.com/en

## Technical Account Management

https://www.redhat.com/en

## Build your skills

## Documentation

https://www.redhat.com/en

Hands-on labs

https://www.redhat.com/en

## Hybrid cloud learning hub

https://www.redhat.com/en

## Interactive learning experiences

https://www.redhat.com/en

## Training and certification

https://www.redhat.com/en

## More ways to learn

https://www.redhat.com/en

## Events and webinars

https://www.redhat.com/en

## Podcasts and video series

https://www.redhat.com/en

## Red Hat TV

https://www.redhat.com/en

## Resource library

https://www.redhat.com/en

## For developers

https://www.redhat.com/en

Discover resources and tools to help you build, deliver, and manage cloud-native applications and services.

## For customers

## Our partners

https://www.redhat.com/en

## Red Hat Ecosystem Catalog

https://www.redhat.com/en

## Find a partner

https://www.redhat.com/en

## For partners

## Partner Connect

https://www.redhat.com/en

## Become a partner

https://www.redhat.com/en

https://www.redhat.com/en

https://www.redhat.com/en

## Access the partner portal

https://www.redhat.com/en

## Build solutions powered by trusted partners

https://www.redhat.com/en

Find solutions from our collaborative community of experts and technologies in the Red Hat® Ecosystem Catalog.

I'd like to:

## Start a trial

https://www.redhat.com/en

## Manage subscriptions

https://www.redhat.com/en

## See Red Hat jobs

https://www.redhat.com/en

## Explore tech topics

https://www.redhat.com/en

## Contact sales

https://www.redhat.com/en

## Contact customer service

https://www.redhat.com/en

Help me find:

## Documentation

https://www.redhat.com/en

## Developer resources

https://www.redhat.com/en

## Skills assessments

https://www.redhat.com/en

## Architecture center

https://www.redhat.com/en

## Security updates

https://www.redhat.com/en

## Support cases

https://www.redhat.com/en

I want to learn more about:

https://www.redhat.com/en

## Application modernization

https://www.redhat.com/en

https://www.redhat.com/en

Cloud-native applications

https://www.redhat.com/en

https://www.redhat.com/en

## Virtualization

https://www.redhat.com/en

https://www.redhat.com/en

https://www.redhat.com/en

https://www.redhat.com/en

## New  For you

## Recommended

We'll recommend resources you may like as you browse. Try these suggestions for now.

## Product trial center

https://www.redhat.com/en

## Courses and exams

https://www.redhat.com/en

## All products

https://www.redhat.com/en

## Tech topics

https://www.redhat.com/en

## Resource library

https://www.redhat.com/en

## Get more with a Red Hat account

## Console access

## Event registration

Training & trials

World-class support

A subscription may be required for some services.

## Log in or register

https://www.redhat.com/en

https://www.redhat.com/en

## Edit avatar

https://www.redhat.com/en

Login:  [[login]]

Account number:  [[account_number]]

## Red Hat Blog

https://www.redhat.com/en/blog

https://www.redhat.com/en/blog

https://www.redhat.com/en/blog

## Red Hat Ansible Automation Platform

https://www.redhat.com/en/blog

## Red Hat Enterprise Linux

https://www.redhat.com/en/blog

## Red Hat OpenShift

https://www.redhat.com/en/blog

## More products

https://www.redhat.com/en/blog

https://www.redhat.com/en/blog

https://www.redhat.com/en/blog

## Virtualization

https://www.redhat.com/en/blog

## Applications

https://www.redhat.com/en/blog

https://www.redhat.com/en/blog

## Cloud services

https://www.redhat.com/en/blog

## Edge computing

https://www.redhat.com/en/blog

## Infrastructure

https://www.redhat.com/en/blog

## Open hybrid cloud

https://www.redhat.com/en/blog

## Original shows

https://www.redhat.com/en/blog

https://www.redhat.com/en/blog

https://www.redhat.com/en/blog

https://www.redhat.com/en/blog

## Technically Speaking with Chris Wright

https://www.redhat.com/en/blog

## Code Comments

https://www.redhat.com/en/blog

## Command Line Heroes

https://www.redhat.com/en/blog

https://www.redhat.com/en/blog

https://www.redhat.com/en/blog

## Red Hat Developer blog

https://www.redhat.com/en/blog

## Red Hat Partner Connect blog

https://www.redhat.com/en/blog

Enhancing DeepSeek models with MLA and FP8 optimizations in vLLM

February 4, 2025

Saša Zelenović

https://www.redhat.com/en/authors/sasa-zelenovic

-minute read

## Artificial intelligence

https://www.redhat.com/en/blog?f[0]=taxonomy_topic_tid:75501#rhdc-search-listing

## Subscribe to RSS

## Back to all posts

https://www.redhat.com/en/rss/blog

## A Compressed Summary

## Enhanced Performance

: DeepSeek models see up to 3x throughput and 10x memory capacity improvements with MLA and FP8 kernel optimizations in vLLM v0.7.1.

Scalable Long-Context Inference

: Optimized memory boosts token capacity from 54,560 to 512,000, enabling horizontal scalability with pipeline parallelism.

## New Innovations

: MLA’s "matrix absorption" algorithm and other optimizations reduce memory usage while improving efficiency for complex, high-batch workloads.

## Introduction

The vLLM community has rolled out its latest batch of enhancements to DeepSeek models, including support for

MLA (Multi-Head Latent Attention)

https://github.com/vllm-project/vllm/pull/12601

and optimized

CUTLASS Block FP8 kernels

https://github.com/vllm-project/vllm/pull/11868

. Kudos to Neural Magic’s team at Red Hat for their hard work, specifically Lucas Wilkinson, Tyler Smith, Robert Shaw, and Michael Goin. These improvements increase both generation throughput and memory efficiency, making long-context inference more scalable and cost-effective. In this post, we’ll walk through the key highlights and technical benchmarks.

Performance Gains: 3x Throughput and 10x Memory Capacity

The latest enhancements in vLLM deliver impressive DeepSeek results compared to v0.7.0, and are optimized for long-context generation workloads:

3x increase in generation throughput

10x increase in token memory capacity

Horizontal scalability via vLLM’s pipeline parallelism

For example, on an 8x NVIDIA H200 setup, generation throughput increased by 40% with FP8 kernel optimizations and by 3.4x with MLA. In TP8PP2 (Tensor Parallelism 8, Pipeline Parallelism 2) settings with H100 GPUs, we observed a 26% improvement from FP8 kernels and a 2.8x boost from MLA.

## Memory Optimization and Token Capacity Expansion

The secret to these throughput gains lies in memory optimization. MLA offers approximately 9.6x more memory capacity for key-value (KV) caches, which allows for significantly larger batch sizes during generation. On an 8x H200 setup, token capacity expanded from 54,560 to 512,000 tokens, enabling batch size growth from 13 to 128.

Trade-Offs in Low QPS Scenarios

While MLA excels in large-batch, high-throughput scenarios, it faces some limitations at low queries per second (QPS). Multi-Head Attention (MHA) currently outperforms MLA in these settings, offering better time-to-first-token (TTFT) performance. However, MLA makes up for it by delivering higher efficiency in time-per-output-token (TPOT) under sustained loads. We’re

actively working

https://github.com/vllm-project/vllm/issues/11539

to address this limitation to ensure consistent performance across all workloads.

## About the MLA Algorithm

MLA’s core advantage is its ability to compute directly on latent cache values, bypassing the need to up-project KV cache values. This innovation, based on the "matrix absorption" algorithm introduced in the

DeepSeek V2 paper

https://arxiv.org/abs/2405.04434

, reduces memory overhead while maintaining accuracy. For those interested in a more technical breakdown, we recommend checking out

this explanation of MLA from Tsu Bin

https://github.com/flashinfer-ai/flashinfer/pull/551

## Horizontal Scaling with Pipeline Parallelism

One of vLLM’s standout features is its pipeline parallelism, which supports horizontal scalability for extremely long generations (

watch our recent office hours video

https://www.youtube.com/watch?v=LH2QZehVJoc

to learn about vLLM’s tensor and pipeline parallelism). You can now connect multiple machines—without requiring Infiniband connections—to increase both KV cache capacity and throughput. This makes it easier than ever to serve models like DeepSeek R1 for complex, long-form tasks.

Try It Today with vLLM v0.7.1

## These improvements are already live in

vLLM v0.7.1

https://github.com/vllm-project/vllm/releases

and are compatible with DeepSeek models that leverage MLA, including DeepSeek Coder, V2-Lite, V3, and R1. Update your vLLM installation to start benefiting from the enhanced throughput and memory efficiency.

What’s Next for MLA and DeepSeek Models?

The vLLM community is just getting started. Ongoing work includes optimizations like prefix caching with MLA, expert parallelism, multi-token prediction, and attention data parallelism. Our mission is to provide users with high-efficiency model serving and streamlined usability.

Acknowledgments and Open-Source Collaboration Call-Outs

## This implementation of MLA was led by

## Lucas Wilkinson

https://www.linkedin.com/in/lucas-wilkinson-8174758a/

from Neural Magic’s team at Red Hat. Additionally, we’re grateful to the teams at SGLang, CUTLASS, and FlashInfer for contributing optimized kernels. None of this would be possible without the open-source ecosystem, which continues to drive consistent innovation in vLLM performance engineering.

Get started with AI for enterprise: A beginner’s guide

Explore this beginner's guide to find out how Red Hat OpenShift AI and Red Hat Enterprise Linux AI can accelerate your AI adoption journey.

## Get the resource

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## About the author

Saša Zelenović

## Principal Product Marketing Manager

Saša Zelenović is a Principal Product Marketing Manager at Red Hat, joining in 2025 through the Neural Magic acquisition where he led as Head of Marketing. With a passion for developer-focused marketing, Sasa drives efforts to help developers compress models for inference and deploy them with vLLM. He co-hosts the bi-weekly vLLM Office Hours, a go-to spot for insights and community around all things vLLM.

## Read full bio

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

UI_Icon-Red_Hat-Close-A-Black-RGB

## More like this

## Blog post

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

Red Hat to distribute NVIDIA CUDA across Red Hat AI, RHEL and OpenShift

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Blog post

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

Accelerating Nemotron Nano 2 9B: From Quantization to KV-Cache

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Original podcast

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

Technically Speaking | Security for the AI supply chain

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Original podcast

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

Technically Speaking | Taming AI agents with observability

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Keep exploring

What is agentic AI? Article

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

Predictive AI vs. generative AI Article

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

Top considerations for building a production-ready AI/ML environment E-book

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

Generative AI, the Ansible way Video

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

Innovate and transform with a modern application platform E-book

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Browse by channel

## Explore all channels

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

The latest on IT automation for tech, teams, and environments

## Artificial intelligence

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Updates on the platforms that free customers to run AI workloads anywhere

## Open hybrid cloud

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Explore how we build a more flexible future with hybrid cloud

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## The latest on how we reduce risks across environments and technologies

## Edge computing

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Updates on the platforms that simplify operations at the edge

## Infrastructure

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

The latest on the world’s leading enterprise Linux platform

## Applications

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Inside our solutions to the toughest application challenges

## Virtualization

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

The future of enterprise virtualization for your workloads on-premise or across clouds

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Red Hat Enterprise Linux

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Red Hat OpenShift

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Red Hat Ansible Automation Platform

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## See all products

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Training and certification

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Customer support

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Developer resources

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Find a partner

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Red Hat Ecosystem Catalog

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Documentation

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

Try, buy, & sell

## Product trial center

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Red Hat Store

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

Buy online (Japan)

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Communicate

## Contact sales

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Contact customer service

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## Contact training

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

https://www.redhat.com/en/engage/artificial-intelligence-for-enterprise-beginners-guide-ebook?intcmp=7013a000003Sq0iAAC

## About Red Hat

Red Hat is an open hybrid cloud technology leader, delivering a consistent, comprehensive foundation for transformative IT and artificial intelligence (AI) applications in the enterprise. As a

trusted adviser to the Fortune 500

https://www.redhat.com/en/about/company

, Red Hat offers cloud, developer, Linux, automation, and application platform technologies, as well as

award-winning

https://access.redhat.com/recognition

services.

## Our company

https://access.redhat.com/recognition

## How we work

https://access.redhat.com/recognition

## Customer success stories

https://access.redhat.com/recognition

## Analyst relations

https://access.redhat.com/recognition

https://access.redhat.com/recognition

## Open source commitments

https://access.redhat.com/recognition

## Our social impact

https://access.redhat.com/recognition

https://access.redhat.com/recognition

## Change page language

## Red Hat legal and privacy links

## About Red Hat

https://access.redhat.com/recognition

https://access.redhat.com/recognition

https://access.redhat.com/recognition

https://access.redhat.com/recognition

## Contact Red Hat

https://access.redhat.com/recognition

## Red Hat Blog

https://access.redhat.com/recognition

## Inclusion at Red Hat

https://access.redhat.com/recognition

## Cool Stuff Store

https://access.redhat.com/recognition

## Red Hat Summit

https://access.redhat.com/recognition

© 2025 Red Hat

## Red Hat legal and privacy links

## Privacy statement

https://access.redhat.com/recognition

## Terms of use

https://access.redhat.com/recognition

## All policies and guidelines

https://access.redhat.com/recognition

## Digital accessibility

https://access.redhat.com/recognition

